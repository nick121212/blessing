{"version":3,"sources":["webpack:///./src/pages/page/ctls/page.d3.controller.ts?28a4","webpack:///./src/pages/page/ctls/force.d3.ts?3da9"],"names":[],"mappings":";;;;;;AAKA,sCAAsB,EAAY,CAAC;AAEnC;KAGI,sBAAoB,YAAuC;SAAvC,iBAAY,GAAZ,YAAY,CAA2B;SACvD,IAAI,gBAAK,CAAC,SAAS,CAAC,CAAC;KACzB,CAAC;KAJM,oBAAO,GAAG,CAAC,cAAc,CAAC,CAAC;KAKtC,mBAAC;AAAD,EAAC;AANY,qBAAY,eAMxB;;;;;;;;;ACZD,KAAI,KAAK,GAAG,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE;KAC3C,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE;KAC9B,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE;KAC9B,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AAEhB,KAAI,KAAK,GAAG,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;KAC/D,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;KAClD,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;AAEpD,KAAY,EAAE,uBAAM,EAAI,CAAC;AAEzB;KASI,eAAY,MAAc;SACtB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;SACnB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC;cACvB,MAAM,CAAC,KAAK,CAAC;cACb,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC;cACrB,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;SAC5B,IAAI,CAAC,MAAM,EAAE,CAAC;KAClB,CAAC;KAED,sBAAM,GAAN;SAAA,iBAUC;SATG,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI,EAAE;cAChB,WAAW,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;cACtB,QAAQ,CAAC,GAAG,CAAC;cACb,EAAE,CAAC,MAAM,EAAE;aACR,KAAI,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;aAChE,KAAI,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;aAChE,KAAI,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;SACpE,CAAC,CAAC,CAAC;SACP,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC7B,CAAC;KAED,2BAAW,GAAX;SACI,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;SAEjC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC;cAC/B,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC;cACtB,SAAS,CAAC,QAAQ,CAAC;cACnB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;cAChB,KAAK,EAAE;cACP,MAAM,CAAC,QAAQ,CAAC;cAChB,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;cACZ,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC;cACf,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC;cACf,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC;cACtB,IAAI,CAAE,EAAE,CAAC,IAAI,EAAE;cACX,EAAE,CAAC,OAAO,EAAE,WAAW,CAAC;cACxB,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;cACnB,EAAE,CAAC,KAAK,EAAE,SAAS,CAAS,CAAC,CAAC;SAEvC,qBAAqB,CAAC;aAClB,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;iBAAC,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC;aAC5D,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;aACX,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;SACf,CAAC;SAED,iBAAiB,CAAC;aACd,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;aAClB,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;SACtB,CAAC;SAED,mBAAmB,CAAC;aAChB,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC;iBAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;aAChD,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC;aACZ,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC;SAChB,CAAC;SAED,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;KACzB,CAAC;KAED,2BAAW,GAAX;SACI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC;cAC/B,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC;cACtB,SAAS,CAAC,MAAM,CAAC;cACjB,IAAI,CAAC,KAAK,CAAC;cACX,KAAK,EAAE;cACP,MAAM,CAAC,MAAM,CAAC;cACd,KAAK,CAAC,QAAQ,EAAE,MAAM,CAAC;cACvB,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;SAE9B,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;KACzB,CAAC;KAED,2BAAW,GAAX;SACI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC;cAC/B,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC;cACtB,SAAS,CAAC,MAAM,CAAC;cACjB,IAAI,CAAC,KAAK,CAAC;cACX,KAAK,EAAE;cACP,MAAM,CAAC,MAAM,CAAC;cACd,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC;cACtB,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC;cACd,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;cACb,IAAI,CAAC,UAAU,CAAC;aACb,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;SAClB,CAAC,CAAC,CAAC;SAEP,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;KACzB,CAAC;KAED,sBAAM,GAAN;SACI,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,EAC/B,MAAM,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAEtC,IAAI,CAAC,MAAM,EAAE,CAAC;SACd,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC;cAC3C,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;cAClC,KAAK,CAAC,QAAQ,EAAE,EAAE,CAAC,aAAa,EAAE,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;cAClD,KAAK,CAAC,QAAQ,EAAE,EAAE,CAAC,WAAW,CAAC,KAAK,GAAG,CAAC,EAAE,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;SAE5D,IAAI,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;SAE/B,IAAI,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;SAE/B,IAAI,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;SAE/B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC;cAC5B,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC;cAChB,KAAK,CAAC,MAAM,CAAC,CAAC;SAEnB;aACI,KAAK;kBACA,IAAI,CAAC,IAAI,EAAE,UAAU,CAAiD;iBACnE,MAAM,CAAE,CAAC,CAAC,MAAiC,CAAC,CAAC,IAAI,CAAC,CAAC;aACvD,CAAC,CAAC;kBACD,IAAI,CAAC,IAAI,EAAE,UAAU,CAAiD;iBACnE,MAAM,CAAE,CAAC,CAAC,MAAiC,CAAC,CAAC,IAAI,CAAC,CAAC;aACvD,CAAC,CAAC;kBACD,IAAI,CAAC,IAAI,EAAE,UAAU,CAAiD;iBACnE,MAAM,CAAE,CAAC,CAAC,MAAiC,CAAC,CAAC,IAAI,CAAC,CAAC;aACvD,CAAC,CAAC;kBACD,IAAI,CAAC,IAAI,EAAE,UAAU,CAAiD;iBACnE,MAAM,CAAE,CAAC,CAAC,MAAiC,CAAC,CAAC,IAAI,CAAC,CAAC;aACvD,CAAC,CAAC,CAAC;aACP,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,KAA6B;iBACpD,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC;aACxB,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,KAA6B;iBACjD,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC;aACxB,CAAC,CAAC,CAAC;aACH,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,UAAU,CAAyB;iBAC/C,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;aACpB,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,UAAU,CAAyB;iBAC5C,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;aACpB,CAAC,CAAC,CAAC;SACP,CAAC;KACL,CAAC;KACL,YAAC;AAAD,EAAC;AAhJY,cAAK,QAgJjB","file":"0.54c9e897e4b7633ae909.hot-update.js","sourcesContent":["/**\n * Created by NICK on 16/8/10.\n */\n\nimport * as _ from 'lodash';\nimport { Force } from './force.d3';\n\nexport class D3Controller {\n    static $inject = [\"$stateParams\"];\n\n    constructor(private $stateParams: ng.ui.IStateParamsService) {\n        new Force(\"#paged3\");\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pages/page/ctls/page.d3.controller.ts\n **/","\nvar nodes = [{ name: \"桂林\" }, { name: \"广州\" },\n{ name: \"厦门\" }, { name: \"杭州\" },\n{ name: \"上海\" }, { name: \"青岛\" },\n{ name: \"天津\" }];\n\nvar links = [{ source: 0, target: 1 }, { source: 0, target: 2 },\n{ source: 0, target: 3 }, { source: 1, target: 4 },\n{ source: 1, target: 5 }, { source: 1, target: 6 }];\n\nimport * as d3 from 'd3';\n\nexport class Force {\n    svg: d3.Selection<d3.BaseType, any, any, any>;\n    svgNodes: d3.Selection<d3.BaseType, any, any, any>;\n    svgEdges: d3.Selection<d3.BaseType, any, any, any>;\n    svgTexts: d3.Selection<d3.BaseType, any, any, any>;\n    simulation: any;\n    zoom: d3.ZoomBehavior<d3.ZoomedElementBaseType, any>;\n    nodes: Array<{ name: string }>;\n\n    constructor(select: string) {\n        this.nodes = nodes;\n        this.svg = d3.select(select)\n            .append(\"svg\")\n            .attr(\"width\", \"100%\")\n            .attr(\"height\", \"100%\");\n        this.doDraw();\n    }\n\n    doZoom() {\n        this.zoom = d3.zoom()\n            .scaleExtent([0.5, 10])\n            .duration(400)\n            .on(\"zoom\", () => {\n                this.svg.select(\".nodes\").attr(\"transform\", d3.event.transform);\n                this.svg.select(\".texts\").attr(\"transform\", d3.event.transform);\n                this.svg.select(\".lines\").attr(\"transform\", d3.event.transform);\n            });\n        this.svg.call(this.zoom);\n    }\n\n    doDrawNodes() {\n        let simulation = this.simulation;\n\n        this.svgEdges = this.svg.append(\"g\")\n            .attr(\"class\", \"nodes\")\n            .selectAll(\"circle\")\n            .data(this.nodes)\n            .enter()\n            .append(\"circle\")\n            .attr(\"r\", 5)\n            .attr(\"cx\", 100)\n            .attr(\"cy\", 100)\n            .style(\"fill\", \"black\")\n            .call((d3.drag()\n                .on(\"start\", dragstarted)\n                .on(\"drag\", dragged)\n                .on(\"end\", dragended) as any));\n\n        function dragstarted(d) {\n            if (!d3.event.active) simulation.alphaTarget(0.5).restart();\n            d.fx = d.x;\n            d.fy = d.y;\n        }\n\n        function dragged(d) {\n            d.fx = d3.event.x;\n            d.fy = d3.event.y;\n        }\n\n        function dragended(d) {\n            if (!d3.event.active) simulation.alphaTarget(0);\n            d.fx = null;\n            d.fy = null;\n        }\n\n        return this.svgEdges;\n    }\n\n    doDrawEdges() {\n        this.svgEdges = this.svg.append(\"g\")\n            .attr(\"class\", \"lines\")\n            .selectAll(\"line\")\n            .data(links)\n            .enter()\n            .append(\"line\")\n            .style(\"stroke\", \"#ccc\")\n            .style(\"stroke-width\", 1);\n\n        return this.svgEdges;\n    }\n\n    doDrawTexts() {\n        this.svgTexts = this.svg.append(\"g\")\n            .attr(\"class\", \"texts\")\n            .selectAll(\"text\")\n            .data(nodes)\n            .enter()\n            .append(\"text\")\n            .style(\"fill\", \"black\")\n            .attr(\"dx\", 20)\n            .attr(\"dy\", 8)\n            .text(function (d) {\n                return d.name;\n            });\n            \n        return this.svgTexts;\n    }\n\n    doDraw() {\n        let width = +this.svg.attr(\"width\"),\n            height = +this.svg.attr(\"height\");\n\n        this.doZoom();\n        this.simulation = d3.forceSimulation(this.nodes)\n            .force(\"link\", d3.forceLink(links))\n            .force(\"charge\", d3.forceManyBody().strength(-150))\n            .force(\"center\", d3.forceCenter(width / 2, height / 2));\n\n        let nodes = this.doDrawNodes();\n\n        let edges = this.doDrawEdges();\n\n        let texts = this.doDrawTexts();\n\n        this.simulation.nodes(this.nodes)\n            .on(\"tick\", tick)\n            .force(\"link\");\n\n        function tick() {\n            edges\n                .attr(\"x1\", function (d: d3.SimulationLinkDatum<d3.SimulationNodeDatum>) {\n                    return (d.source as d3.SimulationNodeDatum).x || 0;\n                })\n                .attr(\"y1\", function (d: d3.SimulationLinkDatum<d3.SimulationNodeDatum>) {\n                    return (d.source as d3.SimulationNodeDatum).y || 0;\n                })\n                .attr(\"x2\", function (d: d3.SimulationLinkDatum<d3.SimulationNodeDatum>) {\n                    return (d.target as d3.SimulationNodeDatum).x || 0;\n                })\n                .attr(\"y2\", function (d: d3.SimulationLinkDatum<d3.SimulationNodeDatum>) {\n                    return (d.target as d3.SimulationNodeDatum).y || 0;\n                });\n            nodes.attr(\"cx\", function (datum: d3.SimulationNodeDatum) {\n                return datum.x || 0;\n            }).attr(\"cy\", function (datum: d3.SimulationNodeDatum) {\n                return datum.y || 0;\n            });\n            texts.attr(\"x\", function (d: d3.SimulationNodeDatum) {\n                return d.x || 0;\n            }).attr(\"y\", function (d: d3.SimulationNodeDatum) {\n                return d.y || 0;\n            });\n        }\n    }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/pages/page/ctls/force.d3.ts\n **/"],"sourceRoot":""}