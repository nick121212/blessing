webpackHotUpdate(0,{191:function(t,e,o){"use strict";var s=o(139),i=function(){function t(t,e,o,s,i){var n=this;this.$scope=t,this.$stateParams=e,this.toolbarUtils=o,this.materialUtils=s,this.fxAction=i,this.crawlers={},this.logs=[],this.itemToolbar=[o.btnBuilder("执行操作","",!0).btnClick(function(t,e){n.fxAction.getModel("crawlerSettingAckAction").then(function(o){n.fxAction.doActionModel(t,o,e,function(){n.socket.emit("ack",e,function(e){if(0===e.ret){if(e.showResult)return n.fxAction.getModel("resultAction").then(function(o){n.fxAction.doActionModel(t,o,e,function(){n.materialUtils.close()})});n.materialUtils.showMsg("操作成功！")}else n.materialUtils.showErrMsg(e.msg)})})})}).toValue()],this.$scope.$on("$destroy",function(){n.socket.disconnect(),n.crawlers={}}),this.init()}return t.prototype.init=function(){var t=this;this.socket=s("http://localhost:3000/crawler"),this.socket.on("connect",function(){console.log("connected!!")}),this.socket.on("disconnect",function(){t.crawlers={},t.materialUtils.showErrMsg("socket失去连接！！！")}.bind(this)),this.socket.on("crawler:left",function(e){t.crawlers.hasOwnProperty(e)&&t.materialUtils.safeApply(t.$scope,function(){delete t.crawlers[e]})}.bind(this)),this.socket.on("crawler:update",function(e){t.crawlers.hasOwnProperty(e.socketId)&&t.materialUtils.safeApply(t.$scope,function(){_.extend(t.crawlers[e.socketId],e.data)})}.bind(this)),this.socket.on("crawler:log",function(e){t.logs.length>100&&t.logs.pop(),t.materialUtils.safeApply(t.$scope,function(){t.logs.unshift(e.data)})}.bind(this)),this.socket.on("crawler:join",function(e){t.crawlers||(t.crawlers={}),t.materialUtils.safeApply(t.$scope,function(){t.crawlers[e.id]=e.data})}.bind(this)),this.socket.emit("getCrawlers",{},function(e){t.materialUtils.safeApply(t.$scope,function(){t.crawlers=e})}.bind(this))},t.$inject=["$scope","$stateParams","toolbarUtils","materialUtils","fxAction"],t}();e.TtyController=i},193:function(t,e,o){"use strict";var s=o(191);e.initRouter=function(t,e){e.state("home.tty",{url:"tty",data:{permissions:{except:["anonymous"],only:["user"]}},views:{content:{controller:s.TtyController,controllerAs:"ttyCtl",template:o(131)()}}})}}});
//# sourceMappingURL=0.e87a8b75959c82f170b1.hot-update.js.map