{"version":3,"sources":["webpack:///./src/directives/action/index.ts?1f08","webpack:///./src/directives/action/directives/form.directive.ts?a8d2"],"names":[],"mappings":"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","file":"0.97778f641caafec386f5.hot-update.js","sourcesContent":["import './services/utils.service';\nimport './services/action.provider';\nimport './services/layout.provider';\nimport './services/autocomplete.provider';\nimport './services/jsoneditor.provider';\nimport './services/validator.custom.value';\n\n// import './schemas/modules.value';\n// import './schemas/common.value';\n// import './schemas/backup.value';\n// import './schemas/schema.value';\n// import './schemas/interface.value';\n// import './schemas/action.value';\nimport './schemas/local.value';\n\nimport './directives/form.directive';\nimport './directives/list.directive';\nimport './directives/autocomplete.directive';\nimport './directives/dialog-form.directive';\nimport './directives/search.directive';\nimport './directives/wizard.directive';\nimport './directives/dialog-wizard.directive';\nimport './directives/builder.directive';\n\nimport mdl from './module';\n\nimport './index.scss';\n\nexport default mdl;\n\n\n/** WEBPACK FOOTER **\n ** ./src/directives/action/index.ts\n **/","import { module } from '../module';\nimport { IActionModel, ActionType } from '../models/action.model';\nimport * as pointer from 'json-pointer';\nimport * as _ from 'lodash';\n\ninterface IDirectiveScope extends ng.IScope {\n\n}\n\ninterface IDirectiveAttr extends ng.IAttributes {\n\n}\n\nclass Controller {\n    static $inject = [\"$scope\", \"fxAction\"];\n\n    actionModel: IActionModel;\n    key: string;\n    ngModel: Object;\n    formData: Object;\n    isBusy: boolean;\n\n    constructor(private $scope, private fxAction) {\n        this.$scope.$on(\"$destroy\", () => {\n            this.formData = null;\n            this.actionModel = null;\n            this.ngModel = null;\n        });\n        if (this.actionModel) {\n            this.getModelData(this.actionModel);\n        }\n    }\n\n    getModelData(actionModel: IActionModel) {\n        // 取得数据中的特定部分\n        if (actionModel.type === ActionType.form && actionModel.form) {\n            if (pointer.has(this.ngModel, actionModel.form.path || \"\")) {\n                this.formData = pointer.get(this.ngModel, actionModel.form.path || \"\");\n            }\n        }\n        !this.formData && (this.formData = {});\n    }\n\n    getActionModel() {\n        this.isBusy = true;\n        this.fxAction.getModel(this.key).then((actionModel: IActionModel) => {\n            this.getModelData(actionModel);\n            return this.fxAction.getSchema(actionModel);\n        }).then((model) => {\n             this.actionModel = model;\n        }).then((this.actionModel)=>{\n            return this.fxAction.doAction(this.key,this.formData,null,\"open\");\n        }).then(()=>{\n            \n        }).finally(() => {\n            this.isBusy = false;\n        });\n    }\n}\n\n/**\n * 操作指令,某个表单操作\n * @returns {{restrict: string, template: any, scope: {}, replace: boolean, link: (($scope:IDirectiveScope))}}\n * @constructor\n */\nfunction Directive(): ng.IDirective {\n    return {\n        restrict: 'EA',\n        template: require(\"../tpls/form.jade\")(),\n        scope: true,\n        require: \"^fxFormAction\",\n        bindToController: {\n            ngModel: \"=ngModel\",\n            actionModel: \"=?\",\n            isBusy: \"=?ngDisabled\",\n            key: \"@?\"\n        },\n        controller: Controller,\n        controllerAs: 'formCtl',\n        replace: true,\n        transclude: true,\n        link: ($scope: IDirectiveScope, $ele: ng.IAugmentedJQuery, $attrs: IDirectiveAttr, $ctl: Controller) => {\n            $scope.$watch(() => {\n                return $ctl.key;\n            }, (newValue) => {\n                newValue && $ctl.getActionModel();\n            });\n        }\n    };\n}\n\nmodule.directive(\"fxFormAction\", Directive);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/directives/action/directives/form.directive.ts\n **/"],"sourceRoot":""}