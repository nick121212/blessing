webpackHotUpdate(0,{191:function(t,e,i){"use strict";var o=i(139),s=function(){function t(t,e,i,o,s){var n=this;this.$scope=t,this.$stateParams=e,this.toolbarUtils=i,this.materialUtils=o,this.fxAction=s,this.crawlers={},this.logs=[],this.itemToolbar=[i.btnBuilder("执行操作","",!0).btnClick(function(t,e){n.fxAction.getModel("crawlerSettingAckAction").then(function(i){n.fxAction.doActionModel(t,i,e,function(){n.socket.emit("ack",e,function(e){if(0===e.ret){if(e.showResult)return n.fxAction.getModel("resultAction").then(function(i){n.fxAction.doActionModel(t,i,e,function(){n.materialUtils.close()})});n.materialUtils.showMsg("操作成功！")}else n.materialUtils.showErrMsg(e.msg)})})})}).toValue()],this.$scope.$on("$destroy",function(){n.socket.disconnect(),n.crawlers={}}),this.init()}return t.prototype.init=function(){var t=this;this.socket=o("http://114.55.146.215:3000/crawler"),this.socket.on("connect",function(){console.log("connected!!")}),this.socket.on("disconnect",function(){t.crawlers={},t.materialUtils.showErrMsg("socket失去连接！！！")}.bind(this)),this.socket.on("crawler:left",function(e){t.crawlers.hasOwnProperty(e)&&t.materialUtils.safeApply(t.$scope,function(){delete t.crawlers[e]})}.bind(this)),this.socket.on("crawler:update",function(e){t.crawlers.hasOwnProperty(e.socketId)&&t.materialUtils.safeApply(t.$scope,function(){_.extend(t.crawlers[e.socketId],e.data)})}.bind(this)),this.socket.on("crawler:log",function(e){t.logs.length>100&&t.logs.pop(),t.materialUtils.safeApply(t.$scope,function(){t.logs.unshift(e.data)})}.bind(this)),this.socket.on("crawler:join",function(e){t.crawlers||(t.crawlers={}),t.materialUtils.safeApply(t.$scope,function(){t.crawlers[e.id]=e.data})}.bind(this)),this.socket.emit("getCrawlers",{},function(e){t.materialUtils.safeApply(t.$scope,function(){t.crawlers=e})}.bind(this))},t.$inject=["$scope","$stateParams","toolbarUtils","materialUtils","fxAction"],t}();e.TtyController=s},193:function(t,e,i){"use strict";var o=i(191);e.initRouter=function(t,e){e.state("home.tty",{url:"tty",data:{permissions:{except:["anonymous"],only:["user"]}},views:{content:{controller:o.TtyController,controllerAs:"ttyCtl",template:i(131)()}}})}}});
//# sourceMappingURL=0.644ca5fda98bff49ecd4.hot-update.js.map